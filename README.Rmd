---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-pressure-1.png",
  out.width = "100%"
)
```

# NLJ

<!-- badges: start -->
<!-- badges: end -->

The goal of nlj is to provide functions for statistical transformations,
distributions, and normalization methods, particularly leveraging the Johnson
SU distribution and the generalized inverse hyperbolic sine transformation.

## Installation

You can install the development version of nlj from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("shanedrabing/nlj")
```

## Example

Below are examples showcasing some key functions in the `nlj` package.

### Total Absolute Deviation from Theoretical CDF

The `qqtad` function calculates the total absolute deviation from a theoretical
cumulative distribution function (CDF):

```{r example-qqtad}
library(nlj)

# Example probabilities
p <- c(0.1, 0.3, 0.6, 0.8)

# Calculate the total absolute deviation
qqtad(p)
```

### Generalized Inverse Hyperbolic Sine Transformation

The `gasinh` and `gsinh` functions apply and reverse the generalized
inverse hyperbolic sine transformation:

```{r example-gasinh}
x <- c(-1, 0, 1, 2, 3)

# Apply generalized inverse hyperbolic sine transformation
transformed <- gasinh(x)
transformed

# Reverse the transformation
inverse_transformed <- gsinh(transformed)
inverse_transformed
```

### Johnson SU Distribution Functions

The Johnson SU distribution functions `djohnson`, `pjohnson`, `qjohnson`, and
`rjohnson` provide density, cumulative distribution, quantile, and random
variate generation capabilities.

#### Density

```{r example-djohnson}
# Density at x = 0
djohnson(0, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

#### Cumulative Distribution

```{r example-pjohnson}
# Cumulative probability at q = 0.5
pjohnson(0.5, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

#### Quantile Function

```{r example-qjohnson}
# Quantile for probability p = 0.5
qjohnson(0.5, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

#### Random Deviate Generation

```{r example-rjohnson}
# Generate 5 random deviates
rjohnson(5, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

### Z-Score Normalization

The `znorm` function normalizes a numeric vector using Z-score normalization:

```{r example-znorm}
# Sample data
x <- c(1, 2, 3, 4, 5)

# Apply Z-score normalization
z_norm <- znorm(x)
z_norm$z  # Normalized values

# Reverse the normalization
denormalized <- z_norm$denormalize(z_norm$z)
denormalized
```

### Johnson SU Normalization

The `zjohnson` function normalizes data using the Johnson SU distribution:

```{r example-zjohnson}
# Normalize using Johnson SU distribution
johnson_norm <- zjohnson(x)
johnson_norm$z  # Normalized values

# Reverse the normalization
denormalized_johnson <- johnson_norm$denormalize(johnson_norm$z)
denormalized_johnson
```

### Density Estimation Comparison

This example compares the density estimation of the original data (`airquality$Wind`) with the densities after applying Z-score normalization and Johnson SU normalization.

```{r example-density-comparison}
# Example data: Wind speed
x <- sort(airquality$Wind)
d <- density(x)

# Apply Z-score normalization and Johnson SU normalization
zn <- znorm(x)
zj <- zjohnson(x)

# Extract the density estimates
xd <- d$x
yd <- d$y
yn <- zn$fd(xd)
yj <- zj$fd(xd)

# Plot the density comparison
plot(range(xd), range(c(yd, yn, yj)), type = "n",
     main = "Wind Speed Density Estimation",
     xlab = "Wind Speed", ylab = "Density")
lines(xd, yd, col = "black")  # Original density
lines(xd, yn, col = "red")    # Z-score normalized density
lines(xd, yj, col = "blue")   # Johnson SU normalized density
```
