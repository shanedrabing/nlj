---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dpi = 300,
  fig.path = "man/figures/",
  fig.width = 9,
  fig.height = 6,
  out.width = "100%"
)
```

# NLJ

This package, `nlj`, is named after the British statistician, Norman Lloyd
Johnson. Its goal is primarily to provide functions to work with the Johnson-SU
(unbounded system) distribution. Additionally, automatic normalization
functions and a generalized transformational regression model based off of the
inverse hyperbolic sine function are provided.

## Installation

You can install the development version of `nlj` as follows:

``` r
# install.packages("devtools")
devtools::install_github("shanedrabing/nlj")
```

## Examples

Below are examples showcasing some key functions in the `nlj` package.

### Johnson-SU Distribution Functions

The Johnson-SU distribution functions `djohnson`, `pjohnson`, `qjohnson`, and
`rjohnson` provide density, cumulative distribution, quantile, and random
variate generation capabilities.

#### Density

```{r example-djohnson}
# Density at x = 0
nlj::djohnson(0, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

#### Cumulative Distribution

```{r example-pjohnson}
# Cumulative probability at q = 0
nlj::pjohnson(0, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

#### Quantile Function

```{r example-qjohnson}
# Quantile for probability p = 0.5
nlj::qjohnson(0.5, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

#### Random Deviate Generation

```{r example-rjohnson}
# Generate 5 random deviates
nlj::rjohnson(5, gamma = 0, delta = 1, xi = 0, lambda = 1)
```

### Density Estimation Comparison

This example compares the density estimation of the original data
(`airquality$Wind`) with the densities after applying Z-score normalization and
Johnson-SU normalization.

```{r density-estimation}
# Example data: Wind speed
x <- sort(airquality$Wind)
d <- density(x)

# Apply Z-score normalization and Johnson-SU normalization
zn <- nlj::znorm(x)
zj <- nlj::zjohnson(x)

# Extract the density estimates
xd <- d$x
yd <- d$y
yn <- zn$fd(xd)
yj <- zj$fd(xd)

# Plot the density comparison
plot(range(xd), range(c(yd, yn, yj)), type = "n",
     main = "Wind Speed Density Estimation",
     xlab = "Wind Speed", ylab = "Density")
lines(xd, yd, col = "black")  # Original density
lines(xd, yn, col = "red")    # Z-score normalized density
lines(xd, yj, col = "blue")   # Johnson-SU normalized density
legend(min(xd), max(c(yd, yn, yj)),
       c("Kernel estimation", "Normal", "Johnson-SU"),
       col = c("black", "red", "blue"),
       lwd = 1, bg = "white")
```
